start_date: 2022-06-01T00:00:00
end_date: 2022-06-01T00:00:00

checkpoints:
  forecaster:
    checkpoint_path: /pfs/lustrep4/scratch/project_465001383/aifs/experiments/interpolator/core/fc6h/c1024b16/checkpoint/e0ac0b53da2e4d4a8b1332bdc8aa1f1a/inference-last.ckpt
    leadtimes: 5
  interpolator:
    checkpoint_path: /pfs/lustrep4/scratch/project_465001383/aifs/experiments/interpolator/core/o96/checkpoint/32b2583482d046b29b6678ed3e9a81d8/inference-last.ckpt
    leadtimes: 3
    static_forcings_dataset: ${dataset}

global_land_dataset: ${datasets}/ERA5/aifs-ea-an-oper-0001-mars-o96-1979-2023-6h-v3-land.zarr
global_atm_dataset: ${datasets}/ERA5/aifs-ea-an-oper-0001-mars-o96-1979-2022-6h-v6.zarr


workdir: /pfs/lustrep4/scratch/project_465001383/haugenha/bris-inference-interpolator/run-anemoi/lumi/inference/workdir/
datasets: /pfs/lustrep4/scratch/project_465001383/aifs/dataset/
output: /pfs/lustrep4/scratch/project_465001383/haugenha/bris-inference-interpolator/run-anemoi/lumi/inference/

dataset:
  dataset:
    join:
    - dataset: ${global_atm_dataset}
      drop: ["sdor", "slor", "cp", "u_600", "v_600", "z_600", "t_600", "q_600", "w_600"]
    - dataset: ${global_land_dataset}
      select: ["lcc", "mcc", "hcc", "tcc", "strd", "ssrd"]
    adjust: ["start", "end"]
    reorder: sort
  select: ${select}

frequency: 6h

verif_folder: /pfs/lustrep4/scratch/project_465001383/aifs/verification/nordic/6h/202206_202305/
verif_name: o96_6hfc_1hi.nc #cs1536_n320.nc #cs1536_o96.nc #cs1536_o96.nc #cloudy_skies_o96.nc
verif_name_load: IFS_9km.nc

# dataset_verif:
#   join:
#   - dataset: ${global_atm_dataset}
#     drop: ["sdor", "slor", "cp", "u_600", "v_600", "z_600", "t_600", "q_600", "w_600"]
#   - dataset: ${global_land_dataset}
#     select: ["lcc", "mcc", "tcc", "strd", "ssrd"]
#   adjust: ["start", "end"]
#   reorder: sort


# If the user wants to release GPU cache and memory
# This option releases unused cached/memory used by torch
release_cache: False

# Determine how much the encoder and decoder is chunked
inference_num_chunks: 1

dataloader:
  datamodule:
    _target_: bris.data.dataset.NativeGridDataset
    _convert_: all

hardware:

  num_gpus_per_node: 8
  num_gpus_per_model: 8
  num_nodes: 1


model:
  _target_: bris.model.Interpolator
  _convert_: all


routing:
  - decoder_index: 0
    domain_index: 0
    outputs:
      - netcdf:
          filename_pattern: ${output}/test_interp_1_%Y%m%dT%HZ.nc
          variables: [2t, msl, tp]
          extra_variables: [ws] 
          domain_name: meps

select: ['hcc', 'lcc', 'mcc', 'tcc', 't_925', 'tcw', 'u_100', '10u', '10v', '2d', '2t', 'cos_julian_day', 'cos_latitude', 'cos_local_time', 'cos_longitude', 'insolation', 'lsm', 'msl', 'q_100', 'q_1000', 'q_150', 'q_200', 'q_250', 'q_300', 'q_400', 'q_50', 'q_500', 'q_700', 'q_850', 'q_925', 'sin_julian_day', 'sin_latitude', 'sin_local_time', 'sin_longitude', 'skt', 'sp', 't_100', 't_1000', 't_150', 't_200', 't_250', 't_300', 't_400', 't_50', 't_500', 't_700', 't_850', 'u_1000', 'u_150', 'u_200', 'u_250', 'u_300', 'u_400', 'u_50', 'u_500', 'u_700', 'u_850', 'u_925', 'v_100', 'v_1000', 'v_150', 'v_200', 'v_250', 'v_300', 'v_400', 'v_50', 'v_500', 'v_700', 'v_850', 'v_925', 'w_100', 'w_1000', 'w_150', 'w_200', 'w_250', 'w_300', 'w_400', 'w_50', 'w_500', 'w_700', 'w_850', 'w_925', 'z', 'z_100', 'z_1000', 'z_150', 'z_200', 'z_250', 'z_300', 'z_400', 'z_50', 'z_500', 'z_700', 'z_850', 'z_925']